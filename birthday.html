<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Happy Birthday</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  body{ margin:0; font-family:Poppins, sans-serif; overflow:hidden; background:linear-gradient(180deg,#020212,#08102a); color:#fff; min-height:100vh; display:flex; align-items:center; justify-content:center;}
  .wrap{ position:relative; z-index:10; width:920px; max-width:95%; text-align:center; padding:44px; border-radius:14px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); box-shadow:0 24px 60px rgba(0,0,0,0.65); }
  h1{ color:#ff9ccf; font-size:44px; margin:0 0 12px 0;}
  #typed{ white-space:pre-wrap; color:#ffdff0; font-size:20px; line-height:1.8; max-width:780px; margin:0 auto 18px; }
  .controls{ display:flex; gap:12px; justify-content:center; margin-top:18px; }
  .btn{ background:#ff6fa8;border:none;color:white;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700;}
  .small{ color:#ffdfe8; font-size:13px; margin-top:8px;}
  canvas#bg3{ position:fixed; inset:0; z-index:0; pointer-events:none; }
  canvas#spark{ position:fixed; inset:0; z-index:7; pointer-events:none; }
  /* floating heart style generated by JS */
</style>
</head>
<body>
<script>
  // protection: require bd_access
  (function(){ try{ if(sessionStorage.getItem('bd_access')!=='true') window.location.replace('index.html'); }catch(e){ window.location.replace('index.html'); } })();
</script>

<canvas id="bg3"></canvas>
<canvas id="spark"></canvas>

<div class="wrap">
  <h1>Happy Birthday ðŸŽ‰</h1>
  <div id="typed"></div>

  <div class="controls">
    <button class="btn" id="playAudioBtn">Play </button>
    <button class="btn" onclick="window.location.href='loveletter.html'">Open Letter âžœ</button>
  </div>

  <div class="small">If autoplay is blocked, click "Play".</div>
</div>

<audio id="bgm" loop>
  <source src="audio/bg_piano.mp3" type="audio/mp3">
  Your browser does not support the audio element.
</audio>

<script>
// show name & typewriter
const name = sessionStorage.getItem('bd_name') || 'My Love';
const text = `Dear ${name},\n\nHappy Birthday, my sweetest.\n\nMay your day be as beautiful and warm as your smile.\n\nWaiting to hear your wondrful voice and your laugh\n\nI LOVE YOU`;
let i=0;
const typed = document.getElementById('typed');
(function type(){ if(i<text.length){ typed.innerHTML += text.charAt(i); i++; setTimeout(type, 38); } })();

// audio controls
const bgm = document.getElementById('bgm');
const playBtn = document.getElementById('playAudioBtn');
playBtn.addEventListener('click', ()=>{ bgm.play().catch(()=>alert('Click to enable audio in your browser.')); });
bgm.play().catch(()=>{/* autoplay might be blocked */});

// background 3D floating blobs (subtle)
const bg = document.getElementById('bg3'); const bctx = bg.getContext('2d');
function resizeBg(){ bg.width = innerWidth; bg.height = innerHeight; } window.addEventListener('resize', resizeBg); resizeBg();
const nodes = Array.from({length:7}).map(()=>({ x:Math.random()*innerWidth, y:Math.random()*innerHeight, r:60+Math.random()*160, hue: 280 - Math.random()*120, vx:(Math.random()-0.5)/2, vy:(Math.random()-0.5)/2 }));
function drawBg(){
  bctx.clearRect(0,0,bg.width,bg.height);
  nodes.forEach(n=>{
    n.x += n.vx; n.y += n.vy;
    if(n.x<-300) n.x = bg.width+300; if(n.x>bg.width+300) n.x=-300;
    if(n.y<-300) n.y = bg.height+300; if(n.y>bg.height+300) n.y=-300;
    const g = bctx.createRadialGradient(n.x,n.y,n.r*0.2,n.x,n.y,n.r);
    g.addColorStop(0, `hsla(${n.hue},75%,70%,0.12)`); g.addColorStop(1, `hsla(${n.hue},60%,40%,0.02)`);
    bctx.fillStyle = g; bctx.beginPath(); bctx.ellipse(n.x,n.y,n.r,n.r*0.7,0,0,Math.PI*2); bctx.fill();
  });
  requestAnimationFrame(drawBg);
}
drawBg();

// sparkles canvas
const spark = document.getElementById('spark'); const sctx = spark.getContext('2d');
function resizeSpark(){ spark.width = innerWidth; spark.height = innerHeight; } window.addEventListener('resize', resizeSpark); resizeSpark();
const sparks = [];
function spawnSpark(){ sparks.push({ x: Math.random()*innerWidth, y: Math.random()*innerHeight*0.6, r: Math.random()*2+0.7, vx:(Math.random()-0.5)*0.6, vy:(Math.random()-0.5)*0.6, life:60+Math.random()*80 }); }
setInterval(spawnSpark, 120);
function tickS(){
  sctx.clearRect(0,0,spark.width,spark.height);
  for(let i=sparks.length-1;i>=0;i--){
    const p = sparks[i]; p.x+=p.vx; p.y+=p.vy; p.life--;
    sctx.beginPath(); sctx.fillStyle = `rgba(255,210,230,${Math.max(p.life/120,0)})`; sctx.arc(p.x,p.y,p.r,0,Math.PI*2); sctx.fill();
    if(p.life<=0) sparks.splice(i,1);
  }
  requestAnimationFrame(tickS);
}
tickS();

// floating hearts - DOM elements
setInterval(()=>{
  const el = document.createElement('div');
  const size = 14 + Math.random()*28;
  el.style.width = size+'px'; el.style.height = size+'px';
  el.style.position = 'fixed'; el.style.left = Math.random()*100+'%'; el.style.bottom = '-80px';
  el.style.zIndex = 8; el.style.pointerEvents = 'none';
  el.style.background = 'radial-gradient(circle at 30% 30%, #ff9bc1 0%, #ff6fa8 50%)';
  el.style.borderRadius = '50% 50% 45% 45% / 60% 60% 40% 40%';
  el.style.transform = 'rotate(-45deg)';
  el.style.opacity = 0.95; el.style.transition = 'transform 8s linear, opacity 8s linear';
  document.body.appendChild(el);
  setTimeout(()=> el.style.transform = `translateY(-120vh) scale(1.2)`, 20);
  setTimeout(()=> el.style.opacity = '0', 7000);
  setTimeout(()=> el.remove(), 9000);
}, 900);
</script>
</body>
</html>

